<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>music player</title>
    
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            padding: 30px; 
            background-color: #f4f4f9;
        }
        #player-container {
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            max-width: 400px;
            width: 100%;
            text-align: center;
        }
        #current-track-name {
            display: block;
            margin: 10px 0;
            font-size: 1.1em;
            font-weight: bold;
            color: #333;
        }
        audio {
            width: 100%;
            margin-bottom: 20px;
        }
        
        /* Album Art is now below the audio element */
        #album-art {
            order: 3; /* Set display order below controls */
            width: 100%;
            max-width: 300px;
            height: auto;
            min-height: 100px; 
            border-radius: 5px;
            margin-top: 15px; 
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            object-fit: cover; 
        }

        .controls {
            order: 2;
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
        }
        button { 
            padding: 10px 15px; 
            cursor: pointer; 
            border: none;
            border-radius: 5px;
            font-weight: 600;
            transition: background-color 0.2s;
        }
        #shuffle-btn { background-color: #ff6347; color: white; }
        #loop-btn { background-color: #4682b4; color: white; }
        #next-btn { background-color: #3cb371; color: white; }
        
        button:hover { opacity: 0.8; }
        button:active { opacity: 0.6; }

        /* --- Playlist Styling --- */
        #playlist-button {
            margin-top: 20px;
            background-color: #555;
            color: white;
            padding: 10px 20px;
        }
        #playlist-list {
            list-style: none;
            padding: 0;
            margin-top: 10px;
            width: 100%;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #ccc;
            border-radius: 5px;
            text-align: left;
            display: none; 
        }
        #playlist-list li {
            padding: 10px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
            font-size: 0.95em;
        }
        #playlist-list li:hover {
            background-color: #e0f7fa;
        }
        #playlist-list li.current-track {
            background-color: #bbdefb;
            font-weight: bold;
            color: #1a237e;
        }
    </style>
</head>
<body>

    <div id="player-container">
        <h2>My Hosted Music</h2>
        <span id="current-track-name">Loading...</span>
        
        <audio id="audio-player" controls preload="auto"></audio>

        <div class="controls">
            <button id="shuffle-btn">Shuffle: OFF</button>
            <button id="loop-btn">Loop: OFF</button>
            <button id="next-btn">Next</button>
        </div>
        
        <button id="playlist-button">Show Playlist</button>
        <ul id="playlist-list"></ul>

        <img id="album-art" src="" alt="Album Art" loading="lazy">
    </div>

    <script>
        const audio = document.getElementById('audio-player');
        const shuffleBtn = document.getElementById('shuffle-btn');
        const loopBtn = document.getElementById('loop-btn');
        const nextBtn = document.getElementById('next-btn');
        const currentTrackName = document.getElementById('current-track-name');
        const albumArt = document.getElementById('album-art');
        const playlistList = document.getElementById('playlist-list');
        const playlistButton = document.getElementById('playlist-button');

        // --- CONFIGURATION ---
        const BASE_PATH = 'audio/'; 
        // FIXED: Added closing quote and semicolon
        const PLACEHOLDER_URL = 'https://play-lh.googleusercontent.com/CQri0N-BiyrACHpHPPtITg3TMV5-bZNbAuhjrg-Zpc_mw6tIWZJFPmT8Yr5r4R-xbA';Â ';
        
        // **FINAL PLAYLIST STRUCTURE**
        let rawPlaylist = [
            { track: 'Bloxxin\' What\'s Not Yours.mp3', image: 'Bloxxin_Art.png' }, 
            { track: 'Juice WRLD - Empty Out Your Pockets (Official Fortnite Video) 4.mp3', image: 'Juice_WRLD_1.png' },
            { track: 'Juice WRLD - Lucid Dreams (Official Music Video) 4.mp3', image: 'Juice_WRLD_2.png' },
            { track: 'Marmalade Dream (BOKSED Edit).mp3', image: '' }, 
            { track: 'SODA STREET.mp3', image: '' },
            { track: 'Stay with me remix.mp3', image: 'Stay_Art.jpg' },
            { track: 'Stay with me remix sped up.mp3', image: 'Stay_Art.jpg' },
            { track: 'boksed - Grew.mp3', image: '' },
            { track: 'boxed - skull fairy.mp3', image: 'Skull_Art.png' },
            { track: 'caffeine rush.mp3', image: '' },
            { track: 'dokodemohitori.wav.mp3', image: '' },
            { track: 'look! a turtle.. nevermind..mp3', image: '' },
            { track: 'myinternetlife.mp3.mp3', image: '' },
            { track: 'nostalgiaisntreal.wav.mp3', image: '' }, // FIXED: Added comma here
            { track: 'boksed - 1250.mp3', image: '' },
        ];

        // --- PLAYER STATE ---
        let playlist = [...rawPlaylist]; 
        let originalPlaylist = [...rawPlaylist]; 
        let currentTrackIndex = 0;
        let isShuffling = false;
        let isLooping = false;

        // --- CORE FUNCTIONS ---
        
        function renderPlaylist() {
            playlistList.innerHTML = ''; 
            playlist.forEach((item, index) => {
                const li = document.createElement('li');
                li.textContent = item.track;
                li.dataset.index = index;
                
                if (index === currentTrackIndex) {
                    li.classList.add('current-track');
                }
                
                li.addEventListener('click', () => {
                    loadTrack(index, true); // Pass 'true' to indicate user interaction for playback
                });
                
                playlistList.appendChild(li);
            });
        }

        // Modified loadTrack to optionally play
        function loadTrack(index, autoPlay = false) {
            if (playlist.length === 0) return;
            
            currentTrackIndex = index;
            const currentItem = playlist[currentTrackIndex];
            
            // 1. Set Audio Source
            audio.src = BASE_PATH + currentItem.track; 
            currentTrackName.textContent = currentItem.track;
            
            // 2. Set Album Art (using manual path)
            if (currentItem.image && currentItem.image !== '') {
                albumArt.src = BASE_PATH + currentItem.image;
            } else {
                albumArt.src = PLACEHOLDER_URL;
            }

            // 3. Update UI
            renderPlaylist(); 
            
            audio.load();
            
            // 4. Playback fix: Only call play() if autoPlay is true
            if (autoPlay) {
                audio.play().catch(e => {
                    console.log('Playback attempt blocked:', e);
                });
            }
        }

        function playNextTrack() {
            if (playlist.length === 0) return;
            
            const nextIndex = currentTrackIndex + 1;
            
            if (nextIndex < playlist.length) {
                loadTrack(nextIndex, true); // AutoPlay next track
            } else if (isLooping) {
                loadTrack(0, true); // AutoPlay loop back to 0
            } else {
                audio.pause();
                audio.currentTime = 0;
                currentTrackName.textContent = playlist[currentTrackIndex].track + ' (Playlist Finished)';
                renderPlaylist(); 
            }
        }

        // --- SHUFFLE LOGIC ---

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        shuffleBtn.addEventListener('click', () => {
            isShuffling = !isShuffling;
            shuffleBtn.textContent = `Shuffle: ${isShuffling ? 'ON' : 'OFF'}`;
            
            const wasPlaying = !audio.paused;
            const currentTrack = playlist[currentTrackIndex].track;

            if (isShuffling) {
                shuffleArray(playlist);
            } else {
                playlist = [...originalPlaylist];
            }
            
            currentTrackIndex = playlist.findIndex(item => item.track === currentTrack);

            if (wasPlaying) {
                loadTrack(currentTrackIndex, true); // AutoPlay on shuffle if it was playing
            } else {
                currentTrackName.textContent = playlist[currentTrackIndex].track;
                // Update image and playlist list, but don't play
                if (playlist.length > 0) {
                    const currentItem = playlist[currentTrackIndex];
                    if (currentItem.image && currentItem.image !== '') {
                        albumArt.src = BASE_PATH + currentItem.image;
                    } else {
                        albumArt.src = PLACEHOLDER_URL;
                    }
                }
                renderPlaylist(); 
            }
        });

        // --- LOOP, NEXT, & EVENTS LOGIC ---

        loopBtn.addEventListener('click', () => {
            isLooping = !isLooping;
            loopBtn.textContent = `Loop: ${isLooping ? 'ON' : 'OFF'}`;
        });

        nextBtn.addEventListener('click', () => {
            playNextTrack();
        });

        audio.addEventListener('ended', () => {
            playNextTrack();
        });

        playlistButton.addEventListener('click', () => {
            const isVisible = playlistList.style.display !== 'none';
            playlistList.style.display = isVisible ? 'none' : 'block';
            playlistButton.textContent = isVisible ? 'Show Playlist' : 'Hide Playlist';
        });

        // --- INITIALIZATION ---
        // Load the first track without auto-playing (fixes NotAllowedError)
        if (playlist.length > 0) {
            loadTrack(0, false); // load the track data, but DO NOT call play()
        } else {
            currentTrackName.textContent = 'Playlist is empty.';
        }
    </script>
</body>
</html>
